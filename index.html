<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel Module</title>
  <link rel="stylesheet" href="assets/scss/css/bootstrap.min.css">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  
  <div class="d-flex" id="wrapper">

    <!-- Sidebar -->
    <div class="bg-emphasis text-primary p-3" id="sidebar" style="width: 250px; min-height: 100vh;">
      <h4 class="text-center mb-3">Admin Panel</h4>
      <div class="list-group list-group-flush">
        <a class="list-group-item list-group-item-action bg-primary text-white" data-bs-toggle="collapse" href="#dashboardMenu">
          <i class="bi bi-speedometer2 me-2"></i> Admin Dashboard
        </a>
        <div class="collapse ps-3" id="dashboardMenu">
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Overview</a>
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Revenue Graphs</a>
        </div>

        <a class="list-group-item list-group-item-action bg-primary text-white mt-1" data-bs-toggle="collapse" href="#userMenu">
          <i class="bi bi-people-fill me-2"></i> User Management
        </a>
        <div class="collapse ps-3" id="userMenu">
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">View Users</a>
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Assign Roles</a>
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Suspend/Activate</a>
        </div>

        <a class="list-group-item list-group-item-action bg-primary text-white mt-1" data-bs-toggle="collapse" href="#propertyMenu">
          <i class="bi bi-house-fill me-2"></i> Property Management
        </a>
        <div class="collapse ps-3" id="propertyMenu">
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Approve Listings</a>
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Manage Properties</a>
        </div>

        <a class="list-group-item list-group-item-action bg-primary text-white mt-1" data-bs-toggle="collapse" href="#paymentMenu">
          <i class="bi bi-currency-exchange me-2"></i> Payments & Transactions
        </a>
        <div class="collapse ps-3" id="paymentMenu">
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Track Payments</a>
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Reports</a>
        </div>

        <a class="list-group-item list-group-item-action bg-primary text-white mt-1" data-bs-toggle="collapse" href="#settingsMenu">
          <i class="bi bi-gear-fill me-2"></i> System Settings
        </a>
        <div class="collapse ps-3" id="settingsMenu">
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">API Configuration</a>
          <a href="#" class="list-group-item list-group-item-action bg-primary text-white">Booking Rules</a>
        </div>

      </div>
    </div>
    <!-- /#sidebar -->

    <!-- Page Content -->
    <div class="flex-grow-1 p-4" id="page-content">
      <header class="mb-4">
        <h2>Welcome, Admin</h2>
        <p>Select a module from the sidebar to manage it.</p>
      </header>

  
  <main class="container my-5">
    <div class="row g-4">

      <!-- Module Card Template -->
<!-- Admin Dashboard Section -->
<div class="card shadow mb-4">
  <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
    <h5 class="mb-0"><i class="bi bi-speedometer2 me-2"></i>Admin Dashboard</h5>
    <button class="btn btn-sm btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#dashboardContent">
      <i class="bi bi-chevron-down"></i>
    </button>
  </div>
  
  <div class="collapse show" id="dashboardContent">
    <div class="card-body">
      
      <!-- Platform Statistics -->
      <div class="mb-4">
        <h6 class="text-primary"><i class="bi bi-bar-chart-fill me-2"></i>Platform Statistics</h6>
        <div class="row text-center">
          <div class="col-md-3 mb-3">
            <div class="bg-light p-3 rounded shadow-sm">
              <h3 class="text-primary" id="totalUsers">120</h3>
              <p class="mb-0">Total Users</p>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="bg-light p-3 rounded shadow-sm">
              <h3 class="text-primary" id="listedProperties">45</h3>
              <p class="mb-0">Listed Properties</p>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="bg-light p-3 rounded shadow-sm">
              <h3 class="text-primary" id="activeTenants">78</h3>
              <p class="mb-0">Active Tenants</p>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="bg-light p-3 rounded shadow-sm">
              <h3 class="text-primary" id="inquiries">32</h3>
              <p class="mb-0">Inquiries</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Revenue Graph -->
      <div class="mb-4">
        <h6 class="text-primary"><i class="bi bi-graph-up me-2"></i>Revenue & Bookings</h6>
        <canvas id="revenueChart" width="300" height="100"></canvas>
      </div>

      <!-- Platform Performance -->
      <div class="mb-4">
        <h6 class="text-primary"><i class="bi bi-bar-chart-line me-2"></i>Performance Metrics</h6>
        <canvas id="performanceChart" width="300" height="100"></canvas>
      </div>

      <!-- Occupancy Rate -->
      <div>
        <h6 class="text-primary"><i class="bi bi-house-fill me-2"></i>House Occupancy Rate</h6>
        <canvas id="occupancyChart" width="50" height="70"></canvas>
      </div>

    </div>
  </div>
</div>

      <!-- User Management -->
  <div class="card shadow mb-4">
  <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
    <h5 class="mb-0"><i class="bi bi-people-fill me-2"></i>User Management</h5>
    <button class="btn btn-sm btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#userContent">
      <i class="bi bi-chevron-down"></i>
    </button>
  </div>

  <div class="collapse show" id="userContent">
    <div class="card-body">

    
       <!-- Top buttons -->
      <div class="d-flex justify-content-between mb-3">
        <input type="text" id="userSearch" class="form-control w-50" placeholder="Search users...">
        <button class="btn btn-primary" onclick="openAddModal()"><i class="bi bi-plus-circle me-1"></i>Add New User</button>
      </div>

      <!-- User Table -->
      <div class="table-responsive">
        <table class="table table-hover align-middle" id="userTable">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Email</th>
              <th>Role</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- Example users -->
            <tr>
              <td>1</td>
              <td>John Doe</td>
              <td>john@example.com</td>
              <td>Tenant</td>
              <td><span class="badge bg-success">Active</span></td>
              <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editUser(1)">Edit</button>
                <button class="btn btn-sm btn-warning me-1" onclick="toggleStatus(1)">Suspend</button>
                <button class="btn btn-sm btn-danger" onclick="deleteUser(1)">Delete</button>
              </td>
            </tr>
            <tr>
              <td>2</td>
              <td>Jane Smith</td>
              <td>jane@example.com</td>
              <td>Landlord</td>
              <td><span class="badge bg-success">Active</span></td>
              <td>
                <button class="btn btn-sm btn-primary me-1" onclick="editUser(2)">Edit</button>
                <button class="btn btn-sm btn-warning me-1" onclick="toggleStatus(2)">Suspend</button>
                <button class="btn btn-sm btn-danger" onclick="deleteUser(2)">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
  </div>
</div>
<!-- Edit User Modal -->
<div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="editUserModalLabel"><i class="bi bi-pencil-square me-2"></i>Edit User</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="editUserForm">
          <input type="hidden" id="editUserId">
          <div class="mb-3">
            <label for="editUserName" class="form-label">Name</label>
            <input type="text" class="form-control" id="editUserName" required>
          </div>
          <div class="mb-3">
            <label for="editUserEmail" class="form-label">Email</label>
            <input type="email" class="form-control" id="editUserEmail" required>
          </div>
          <div class="mb-3">
            <label for="editUserRole" class="form-label">Role</label>
            <select class="form-select" id="editUserRole">
              <option value="Tenant">Tenant</option>
              <option value="Landlord">Landlord</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="editUserStatus" class="form-label">Status</label>
            <select class="form-select" id="editUserStatus">
              <option value="Active">Active</option>
              <option value="Suspended">Suspended</option>
            </select>
          </div>
          <button type="submit" class="btn btn-primary w-100">Save Changes</button>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- Add User Modal -->
<div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title" id="addUserModalLabel"><i class="bi bi-plus-circle me-2"></i>Add New User</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="addUserForm">
          <div class="mb-3">
            <label for="addUserName" class="form-label">Name</label>
            <input type="text" class="form-control" id="addUserName" required>
          </div>
          <div class="mb-3">
            <label for="addUserEmail" class="form-label">Email</label>
            <input type="email" class="form-control" id="addUserEmail" required>
          </div>
          <div class="mb-3">
            <label for="addUserRole" class="form-label">Role</label>
            <select class="form-select" id="addUserRole">
              <option value="Tenant">Tenant</option>
              <option value="Landlord">Landlord</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="addUserStatus" class="form-label">Status</label>
            <select class="form-select" id="addUserStatus">
              <option value="Active">Active</option>
              <option value="Suspended">Suspended</option>
            </select>
          </div>
          <button type="submit" class="btn btn-success w-100">Add User</button>
        </form>
      </div>
    </div>
  </div>
</div>


      <!-- Property Management -->
      <div class="col-md-6 col-lg-4">
        <div class="card h-100 shadow card-hover">
          <div class="card-header bg-warning text-white d-flex align-items-center justify-content-between">
            <span><i class="bi bi-house-fill me-2"></i>Property Management</span>
            <button class="btn btn-sm btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#propertyCollapse">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
          <div class="collapse" id="propertyCollapse">
            <div class="card-body">
              <ul>
                <li>Approve or reject property listings</li>
                <li>Update property details (availability, pricing)</li>
                <li>Monitor occupancy rates and listing accuracy</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Inquiries & Chat Monitoring -->
      <div class="col-md-6 col-lg-4">
        <div class="card h-100 shadow card-hover">
          <div class="card-header bg-info text-white d-flex align-items-center justify-content-between">
            <span><i class="bi bi-chat-dots-fill me-2"></i>Inquiries & Chat Monitoring</span>
            <button class="btn btn-sm btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#chatCollapse">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
          <div class="collapse" id="chatCollapse">
            <div class="card-body">
              <ul>
                <li>Real-time chat monitoring via Socket.IO</li>
                <li>Access stored chat logs through MySQL</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Payments & Transactions -->
      <div class="col-md-6 col-lg-4">
        <div class="card h-100 shadow card-hover">
          <div class="card-header bg-danger text-white d-flex align-items-center justify-content-between">
            <span><i class="bi bi-currency-exchange me-2"></i>Payments & Transactions</span>
            <button class="btn btn-sm btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#paymentCollapse">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
          <div class="collapse" id="paymentCollapse">
            <div class="card-body">
              <ul>
                <li>Track payments via Daraja Mpesa API</li>
                <li>Manage payment statuses (successful, failed, pending)</li>
                <li>Generate revenue reports and invoices</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Announcements & Notifications -->
      <div class="col-md-6 col-lg-4">
        <div class="card h-100 shadow card-hover">
          <div class="card-header bg-secondary text-white d-flex align-items-center justify-content-between">
            <span><i class="bi bi-bell-fill me-2"></i>Announcements & Notifications</span>
            <button class="btn btn-sm btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#announceCollapse">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
          <div class="collapse" id="announceCollapse">
            <div class="card-body">
              <ul>
                <li>Post platform-wide announcements</li>
                <li>Manage notifications for system events</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Reports & Analytics -->
      <div class="col-md-6 col-lg-4">
        <div class="card h-100 shadow card-hover">
          <div class="card-header bg-dark text-white d-flex align-items-center justify-content-between">
            <span><i class="bi bi-graph-up-arrow me-2"></i>Reports & Analytics</span>
            <button class="btn btn-sm btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#reportCollapse">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
          <div class="collapse" id="reportCollapse">
            <div class="card-body">
              <ul>
                <li>Generate detailed reports on platform usage</li>
                <li>Export reports in PDF or Excel</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- System Settings -->
      <div class="col-md-6 col-lg-4">
        <div class="card h-100 shadow card-hover">
          <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
            <span><i class="bi bi-gear-fill me-2"></i>System Settings</span>
            <button class="btn btn-sm btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#settingsCollapse">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
          <div class="collapse" id="settingsCollapse">
            <div class="card-body">
              <ul>
                <li>Configure Google Maps & Mpesa APIs</li>
                <li>Manage property categories and booking rules</li>
                <li>Set notification preferences</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-light text-center py-3">
    &copy; 2026 Admin Panel System | All Rights Reserved
  </footer>

  <script src="assets/scss/js/bootstrap.min.js"></script>
  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Revenue Chart (Line)
  const revenueCtx = document.getElementById('revenueChart').getContext('2d');
  const revenueChart = new Chart(revenueCtx, {
    type: 'line',
    data: {
      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
      datasets: [
        {
          label: 'Bookings ($)',
          data: [1200, 1500, 1400, 1800, 2000, 2200],
          borderColor: '#0d6efd',
          backgroundColor: 'rgba(13, 110, 253, 0.2)',
          tension: 0.3,
        },
        {
          label: 'Payments ($)',
          data: [1100, 1400, 1300, 1700, 1900, 2100],
          borderColor: '#198754',
          backgroundColor: 'rgba(25, 135, 84, 0.2)',
          tension: 0.3,
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'top' },
      }
    }
  });

  // Performance Chart (Bar)
  const performanceCtx = document.getElementById('performanceChart').getContext('2d');
  const performanceChart = new Chart(performanceCtx, {
    type: 'bar',
    data: {
      labels: ['Users', 'Properties', 'Tenants', 'Inquiries'],
      datasets: [{
        label: 'Count',
        data: [120, 45, 78, 32],
        backgroundColor: ['#0d6efd', '#198754', '#ffc107', '#dc3545']
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: false },
      }
    }
  });

  // Occupancy Rate Chart (Doughnut)
  const occupancyCtx = document.getElementById('occupancyChart').getContext('2d');
  const occupancyChart = new Chart(occupancyCtx, {
    type: 'doughnut',
    data: {
      labels: ['Occupied', 'Vacant'],
      datasets: [{
        label: 'Occupancy',
        data: [78, 22], // Example: 78% occupied
        backgroundColor: ['#0d6efd', '#adb5bd']
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'bottom' },
      }
    }
  });
</script>
<script>
/* ==============================
   USER DATA (Persistent)
================================ */
let users = JSON.parse(localStorage.getItem('users')) || [
  { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Tenant', status: 'Active' },
  { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'Landlord', status: 'Active' }
];

/* ==============================
   SAVE TO LOCAL STORAGE
================================ */
function saveUsers() {
  localStorage.setItem('users', JSON.stringify(users));
}

/* ==============================
   RENDER USER TABLE
================================ */
function renderTable(list = users) {
  const tbody = document.querySelector('#userTable tbody');
  tbody.innerHTML = '';

  list.forEach((user, index) => {
    const row = document.createElement('tr');

    row.innerHTML = `
      <td>${index + 1}</td>
      <td>${user.name}</td>
      <td>${user.email}</td>
      <td>${user.role}</td>
      <td>
        <span class="badge ${user.status === 'Active' ? 'bg-success' : 'bg-warning'}">
          ${user.status}
        </span>
      </td>
      <td>
        <button class="btn btn-sm btn-primary me-1" onclick="openEditModal(${user.id})">
          Edit
        </button>
        <button class="btn btn-sm btn-warning me-1" onclick="toggleStatus(${user.id})">
          ${user.status === 'Active' ? 'Suspend' : 'Activate'}
        </button>
        <button class="btn btn-sm btn-danger" onclick="deleteUser(${user.id})">
          Delete
        </button>
      </td>
    `;
    tbody.appendChild(row);
  });
}

/* ==============================
   OPEN ADD USER MODAL
================================ */
function openAddModal() {
  document.getElementById('addUserForm').reset();
  new bootstrap.Modal(document.getElementById('addUserModal')).show();
}

/* ==============================
   OPEN EDIT USER MODAL
================================ */
function openEditModal(id) {
  const user = users.find(u => u.id === id);

  document.getElementById('editUserId').value = user.id;
  document.getElementById('editUserName').value = user.name;
  document.getElementById('editUserEmail').value = user.email;
  document.getElementById('editUserRole').value = user.role;
  document.getElementById('editUserStatus').value = user.status;

  new bootstrap.Modal(document.getElementById('editUserModal')).show();
}

/* ==============================
   ADD USER FORM SUBMIT
================================ */
document.getElementById('addUserForm').addEventListener('submit', function (e) {
  e.preventDefault();

  const newUser = {
    id: users.length ? users[users.length - 1].id + 1 : 1,
    name: document.getElementById('addUserName').value,
    email: document.getElementById('addUserEmail').value,
    role: document.getElementById('addUserRole').value,
    status: document.getElementById('addUserStatus').value
  };

  users.push(newUser);
  saveUsers();
  renderTable();

  bootstrap.Modal.getInstance(document.getElementById('addUserModal')).hide();
});

/* ==============================
   EDIT USER FORM SUBMIT
================================ */
document.getElementById('editUserForm').addEventListener('submit', function (e) {
  e.preventDefault();

  const id = parseInt(document.getElementById('editUserId').value);
  const user = users.find(u => u.id === id);

  user.name = document.getElementById('editUserName').value;
  user.email = document.getElementById('editUserEmail').value;
  user.role = document.getElementById('editUserRole').value;
  user.status = document.getElementById('editUserStatus').value;

  saveUsers();
  renderTable();

  bootstrap.Modal.getInstance(document.getElementById('editUserModal')).hide();
});

/* ==============================
   TOGGLE USER STATUS
================================ */
function toggleStatus(id) {
  const user = users.find(u => u.id === id);
  user.status = user.status === 'Active' ? 'Suspended' : 'Active';

  saveUsers();
  renderTable();
}

/* ==============================
   DELETE USER
================================ */
function deleteUser(id) {
  if (confirm('Are you sure you want to delete this user?')) {
    users = users.filter(u => u.id !== id);
    saveUsers();
    renderTable();
  }
}

/* ==============================
   SEARCH USERS
================================ */
document.getElementById('userSearch').addEventListener('input', function () {
  const search = this.value.toLowerCase();
  const filtered = users.filter(user =>
    user.name.toLowerCase().includes(search) ||
    user.email.toLowerCase().includes(search)
  );
  renderTable(filtered);
});

/* ==============================
   INITIAL LOAD
================================ */
renderTable();
</script>
</body>
</html>
